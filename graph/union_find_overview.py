class DSU:
    def __init__(self, n):
        # Init parents and rank

    def find(self, x):
        # Go up parents recursively and contract paths

    def union(self, x, y):
        # Find parents of x and y
        # If same parents, return False
        # Else, compare their ranks to assign their parents
        return True